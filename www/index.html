
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <link rel="icon" href="/favicon.png" type="image/png">
  <meta name="theme-color" content="#88af25">
  <link rel="manifest" href="/manifest.webmanifest">
  <meta name="viewport" content="width=device-width">
  <title>Gardenr</title>
  <meta name="Description" content="An indoor gardening assistant">
</head>
<body>
  <noscript>JavaScript is disabled!</noscript>
  <h4>Gardenr</h4>
  <div>Updated: <span id="updated"></span></div>
  <script>
    for (;;) {
      setTimeout(function() {
        var xmlhttp = new XMLHttpRequest();
        xmlhttp.open('GET', '/data.json', true);
        xmlhttp.onreadystatechange = function() {
          if (xmlhttp.readyState == 4) {
            if(xmlhttp.status == 200) {
              var obj = JSON.parse(xmlhttp.responseText);
              var updatedTimestamp = obj.updated;
              document.getElementById('updated').innerHTML = Date(updatedTimestamp);
            }
          }
          xmlhttp.send(null);
        }
      }, 3000);
    }

    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('/sw.js')
      .then((registration) => {
        console.log('[SW] Service worker is all cool.');
      }).catch(function(e) {
        console.error('[SW] Service worker is not so cool.', e);
        throw e;
      });
    }
  </script>
</body>
</html>
